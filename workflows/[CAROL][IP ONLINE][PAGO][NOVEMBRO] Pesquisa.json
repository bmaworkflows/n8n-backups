{
  "active": true,
  "connections": {
    "Trata Webhook": {
      "main": [
        [
          {
            "node": "Trata Etapas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trata Etapas": {
      "main": [
        [
          {
            "node": "Dados Planilha |Central funis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Trata Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-11-06T04:53:02.005Z",
  "id": "SwZIzWn77bpOSwyP",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "[CAROL][IP ONLINE][PAGO][NOVEMBRO] Pesquisa",
  "nodes": [
    {
      "parameters": {
        "jsCode": "return typeof $node[\"Webhook\"].json[\"body\"] == 'string' ? JSON.parse($node[\"Webhook\"].json[\"body\"]) : $node[\"Webhook\"].json[\"body\"]\n"
      },
      "id": "ff801259-ac10-42fa-baec-e41e9355c5cc",
      "name": "Trata Webhook",
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [
        -440,
        140
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1fpHFTaQK5bZ2NZ6cq2ee1vi4lEKS0r-XtSTO_QVMkbw/edit?gid=1315494972#gid=1315494972",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1315494972,
          "mode": "list",
          "cachedResultName": "pesquisa",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fpHFTaQK5bZ2NZ6cq2ee1vi4lEKS0r-XtSTO_QVMkbw/edit#gid=1315494972"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "já desenvolveu produto?": "={{ $json.desenvolve }}",
            "faturamento": "={{ $json.faturamento }}",
            "cenário": "={{ $json.cenario }}",
            "telefone": "={{ $json.whatsapp }}",
            "chave": "={{ $json.whatsapp.slice(-7) }}",
            "data": "={{ new DateTime($now).format(\"dd/MM/yyyy\") }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "data",
              "displayName": "data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "chave",
              "displayName": "chave",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "cenário",
              "displayName": "cenário",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "faturamento",
              "displayName": "faturamento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "já desenvolveu produto?",
              "displayName": "já desenvolveu produto?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "0adec714-5009-48e4-9269-3b57e781f82f",
      "name": "Dados Planilha |Central funis",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.3,
      "position": [
        20,
        140
      ],
      "retryOnFail": true,
      "maxTries": 5,
      "waitBetweenTries": 5000,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "PLr9msB1lyoRblyJ",
          "name": "Matheus BMA"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const entrada = [\n  {\n    \"cenario\": 2,\n    \"faturamento\": 3,\n    \"desenvolve\": 1,\n    \"whatsapp\": \"5575999928292\"\n  }\n];\n\nconst cenarios = {\n  \"1\": \"Corretor (a) de imóveis\",\n  \"2\": \"Engenheiro (a)\",\n  \"3\": \"Arquiteto (a)\",\n  \"4\": \"Empresário (a) ou empreendedor (a)\",\n  \"5\": \"no mercado imobiliário\",\n  \"6\": \"Incorporador (a)\",\n  \"7\": \"Construtor\",\n  \"8\": \"Sou de outro mercado, mas quero\",\n  \"9\": \"migrar para o desenvolvimento\",\n  \"10\": \"Outros\"\n};\n\nconst faturamentos = {\n  \"1\": \"Até R$ 10.000,00\",\n  \"2\": \"R$ 10.000,00 a R$ 20.000,00\",\n  \"3\": \"R$ 20.000,00 a R$ 50.000,00\",\n  \"4\": \"R$ 50.000,00 a R$ 100.000,00\",\n  \"5\": \"R$ 100.000,00 a R$ 250.000,00\",\n  \"6\": \"R$ 250.000,00 a R$ 500.000,00\",\n  \"7\": \"Acima de R$ 500.000,00\"\n};\n\nconst desenvolvimentos = {\n  \"1\": \"Estou construindo/incorporando no momento\",\n  \"2\": \"Já construí/incorporei, mas não estou construindo/incorporando no momento\",\n  \"3\": \"Nunca construí/incorporei, nem estou construindo/incorporando\"\n};\n\nconst processarLead = (lead) => {\n  return {\n    whatsapp: lead.whatsapp,\n    cenario: cenarios[String(lead.cenario)] || \"lead respondeu fora do padrão\",\n    faturamento: faturamentos[String(lead.faturamento)] || \"lead respondeu fora do padrão\",\n    desenvolve: desenvolvimentos[String(lead.desenvolve)] || \"lead respondeu fora do padrão\"\n  };\n};\n\n// Se estiver usando em um nó Function do n8n com múltiplos itens:\nreturn items.map(item => {\n  return {\n    json: processarLead(item.json)\n  };\n});\n"
      },
      "id": "84dcd2be-bdfb-4b67-be5a-dce7771ffb67",
      "name": "Trata Etapas",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -220,
        140
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "f3472527-4715-44cd-89c2-60dfcfbecf09",
        "options": {}
      },
      "id": "37155ac2-71fb-4407-8e5e-c3ee0e60a2fa",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -640,
        140
      ],
      "webhookId": "f3472527-4715-44cd-89c2-60dfcfbecf09"
    }
  ],
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "webhook.josepbijari.com",
            "user-agent": "ManyChat",
            "content-length": "83",
            "content-type": "application/json; charset=utf-8",
            "x-forwarded-for": "18.185.70.230",
            "x-forwarded-host": "webhook.josepbijari.com",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "467c905f5c94",
            "x-real-ip": "18.185.70.230",
            "accept-encoding": "gzip"
          },
          "params": {},
          "query": {},
          "body": {
            "cenario": "4",
            "faturamento": "7",
            "desenvolve": "1",
            "whatsapp": "5581993515055"
          },
          "webhookUrl": "https://webhook.josepbijari.com/webhook/f3472527-4715-44cd-89c2-60dfcfbecf09",
          "executionMode": "production"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "saveExecutionProgress": true,
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "shared": [
    {
      "updatedAt": "2025-11-06T04:53:02.005Z",
      "createdAt": "2025-11-06T04:53:02.005Z",
      "role": "workflow:owner",
      "workflowId": "SwZIzWn77bpOSwyP",
      "projectId": "AxNpta0sA2v4gJ2a"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2024-05-23T03:18:57.576Z",
      "createdAt": "2024-05-23T03:18:57.576Z",
      "id": "ZAUbeJXqG1plGMYs",
      "name": "carol"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-11-06T04:58:01.065Z",
  "versionId": "80213d11-2256-4959-bf04-fbd5769a7d03"
}